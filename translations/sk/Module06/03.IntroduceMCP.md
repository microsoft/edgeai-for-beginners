# Sekcia 03 - Integrácia Model Context Protocol (MCP)

## Úvod do MCP (Model Context Protocol)

Model Context Protocol (MCP) je otvorený štandard na prepojenie AI aplikácií s externými systémami. Pomocou MCP môžu AI aplikácie ako Claude alebo ChatGPT pripojiť zdroje dát (napr. lokálne súbory, databázy), nástroje (napr. vyhľadávače, kalkulačky) a pracovné postupy (napr. špecializované výzvy), čo im umožňuje prístup k dôležitým informáciám a vykonávanie úloh.

Predstavte si MCP ako **USB-C port pre AI aplikácie**. Rovnako ako USB-C poskytuje štandardizovaný spôsob pripojenia elektronických zariadení, MCP poskytuje štandardizovaný spôsob pripojenia AI aplikácií k externým systémom.

### Čo umožňuje MCP?

MCP odomyká silné schopnosti pre AI aplikácie:

- **Personalizovaní AI asistenti**: Agenti môžu pristupovať k vášmu Google Kalendáru a Notion, čím sa stávajú osobnejšími AI asistentmi
- **Pokročilá generácia kódu**: Claude Code dokáže vytvoriť celú webovú aplikáciu na základe návrhu vo Figma
- **Integrácia podnikových dát**: Podnikové chatboty môžu pristupovať k viacerým databázam v rámci organizácie, čo umožňuje používateľom analyzovať dáta prostredníctvom chatu
- **Kreatívne pracovné postupy**: AI modely môžu vytvárať 3D návrhy v Blenderi a tlačiť ich pomocou 3D tlačiarne
- **Prístup k informáciám v reálnom čase**: Pripojenie k externým zdrojom dát pre aktuálne informácie
- **Komplexné viacstupňové operácie**: Vykonávanie sofistikovaných pracovných postupov kombinujúcich viaceré nástroje a systémy

### Prečo je MCP dôležitý?

MCP prináša výhody naprieč ekosystémom:

**Pre vývojárov**: MCP znižuje čas a zložitosť vývoja pri budovaní alebo integrácii AI aplikácie alebo agenta.

**Pre AI aplikácie**: MCP poskytuje prístup k ekosystému dátových zdrojov, nástrojov a aplikácií, ktoré zlepšujú schopnosti a zlepšujú používateľskú skúsenosť.

**Pre koncových používateľov**: MCP vedie k schopnejším AI aplikáciám alebo agentom, ktorí môžu pristupovať k vašim dátam a vykonávať akcie vo vašom mene, keď je to potrebné.

## Malé jazykové modely (SLMs) v MCP

Malé jazykové modely predstavujú efektívny prístup k nasadeniu AI, ponúkajúc niekoľko výhod:

### Výhody SLMs
- **Efektívnosť zdrojov**: Nižšie požiadavky na výpočtový výkon
- **Rýchlejšie odozvy**: Znížená latencia pre aplikácie v reálnom čase  
- **Nákladová efektívnosť**: Minimálne potreby infraštruktúry
- **Ochrana súkromia**: Môžu bežať lokálne bez prenosu dát
- **Prispôsobenie**: Jednoduchšie doladenie pre špecifické oblasti

### Prečo SLMs dobre fungujú s MCP

SLMs v kombinácii s MCP vytvárajú silnú kombináciu, kde schopnosti modelu v oblasti uvažovania sú rozšírené o externé nástroje, čím kompenzujú ich menší počet parametrov prostredníctvom rozšírenej funkcionality.

## Prehľad Python MCP SDK

Python MCP SDK poskytuje základ pre budovanie aplikácií podporujúcich MCP. SDK zahŕňa:

- **Klientské knižnice**: Na pripojenie k MCP serverom
- **Serverový rámec**: Na vytváranie vlastných MCP serverov
- **Spracovanie protokolu**: Na správu komunikácie
- **Integrácia nástrojov**: Na vykonávanie externých funkcií

## Praktická implementácia: Phi-4 MCP klient

Pozrime sa na implementáciu v reálnom svete pomocou mini modelu Phi-4 od Microsoftu integrovaného s MCP schopnosťami.

### Prehľad architektúry MCP

MCP nasleduje **architektúru klient-server**, kde MCP hostiteľ (AI aplikácia ako Claude Code alebo Claude Desktop) vytvára spojenia s jedným alebo viacerými MCP servermi. MCP hostiteľ to dosahuje vytvorením jedného MCP klienta pre každý MCP server.

#### Kľúčoví účastníci

- **MCP hostiteľ**: AI aplikácia, ktorá koordinuje a spravuje jedného alebo viacerých MCP klientov
- **MCP klient**: Komponent, ktorý udržiava spojenie s MCP serverom a získava kontext od MCP servera pre použitie MCP hostiteľom
- **MCP server**: Program, ktorý poskytuje kontext MCP klientom

#### Dvojvrstvová architektúra

MCP pozostáva z dvoch odlišných vrstiev:

**Dátová vrstva**: Definuje JSON-RPC protokol pre komunikáciu klient-server, vrátane:
- Správy životného cyklu (inicializácia spojenia, vyjednávanie schopností)
- Základných prvkov (nástroje, zdroje, výzvy)
- Funkcií klienta (sampling, elicitation, logovanie)
- Pomocných funkcií (notifikácie, sledovanie pokroku)

**Transportná vrstva**: Definuje mechanizmy a kanály komunikácie:
- **STDIO Transport**: Používa štandardné vstupno-výstupné prúdy pre lokálne procesy (optimálny výkon, žiadne sieťové zaťaženie)
- **Streamable HTTP Transport**: Používa HTTP POST s voliteľnými Server-Sent Events pre vzdialené servery (podporuje štandardnú HTTP autentifikáciu)

```
┌─────────────────────────────────────┐
│           MCP Host                  │
│     (AI Application)                │
└─────────────────┬───────────────────┘
                  │
┌─────────────────┴───────────────────┐
│         MCP Client 1                │
│  ┌─────────────────────────────────┐ │
│  │        Data Layer               │ │
│  │  ├── Lifecycle Management       │ │
│  │  ├── Primitives (Tools/Resources)│ │
│  │  └── Notifications              │ │
│  └─────────────────────────────────┘ │
│  ┌─────────────────────────────────┐ │
│  │      Transport Layer           │ │
│  │  ├── STDIO Transport           │ │
│  │  └── HTTP Transport            │ │
│  └─────────────────────────────────┘ │
└─────────────────┬───────────────────┘
                  │
┌─────────────────┴───────────────────┐
│         MCP Server 1                │
│    (Local/Remote Context Provider)  │
└─────────────────────────────────────┘
```

### Základné prvky MCP

MCP definuje prvky, ktoré špecifikujú typy kontextových informácií, ktoré môžu byť zdieľané s AI aplikáciami, a rozsah akcií, ktoré môžu byť vykonané.

#### Serverové prvky

MCP definuje tri základné prvky, ktoré môžu servery sprístupniť:

**Nástroje**: Vykonateľné funkcie, ktoré môžu AI aplikácie vyvolať na vykonanie akcií
- Príklady: operácie so súbormi, API volania, dotazy do databázy
- Metódy: `tools/list`, `tools/call`
- Podpora dynamického objavovania a vykonávania

**Zdroje**: Dátové zdroje, ktoré poskytujú kontextové informácie AI aplikáciám
- Príklady: obsah súborov, záznamy v databáze, odpovede API
- Metódy: `resources/list`, `resources/read`
- Umožňujú prístup k štruktúrovaným dátam

**Výzvy**: Opakovane použiteľné šablóny, ktoré pomáhajú štruktúrovať interakcie s jazykovými modelmi
- Príklady: systémové výzvy, príklady few-shot
- Metódy: `prompts/list`, `prompts/get`
- Štandardizujú vzory interakcie s AI

#### Klientské prvky

MCP tiež definuje prvky, ktoré môžu klienti sprístupniť na umožnenie bohatších interakcií:

**Sampling**: Umožňuje serverom požadovať dokončenia jazykového modelu od AI aplikácie klienta
- Metóda: `sampling/complete`
- Umožňuje vývoj serverov nezávislých od modelu
- Poskytuje prístup k jazykovému modelu hostiteľa

**Elicitation**: Umožňuje serverom požadovať dodatočné informácie od používateľov
- Metóda: `elicitation/request`
- Umožňuje interakciu s používateľom a potvrdenie
- Podporuje dynamické zhromažďovanie informácií

**Logovanie**: Umožňuje serverom posielať logovacie správy klientom
- Používa sa na ladenie a monitorovanie
- Poskytuje viditeľnosť do operácií servera

### Životný cyklus MCP protokolu

#### Inicializácia a vyjednávanie schopností

MCP je stavový protokol, ktorý vyžaduje správu životného cyklu. Proces inicializácie slúži na niekoľko kritických účelov:

1. **Vyjednávanie verzie protokolu**: Zabezpečuje, že klient aj server používajú kompatibilné verzie protokolu (napr. "2025-06-18")
2. **Objavovanie schopností**: Každá strana deklaruje podporované funkcie a prvky
3. **Výmena identít**: Poskytuje identifikačné a verziovacie informácie

```python
# Example initialization request
{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "initialize",
  "params": {
    "protocolVersion": "2025-06-18",
    "capabilities": {
      "elicitation": {},  # Client supports user interaction
      "sampling": {}      # Client can provide LLM completions
    },
    "clientInfo": {
      "name": "edge-ai-client",
      "version": "1.0.0"
    }
  }
}
```

#### Objavovanie nástrojov a ich vykonávanie

Po inicializácii môžu klienti objavovať a vykonávať nástroje:

```python
# Discover available tools
tools_response = await session.list_tools()

# Execute a tool
result = await session.call_tool(
    "weather_current",
    {
        "location": "San Francisco",
        "units": "imperial"
    }
)
```

#### Notifikácie v reálnom čase

MCP podporuje notifikácie v reálnom čase pre dynamické aktualizácie:

```python
# Server sends notification when tools change
{
  "jsonrpc": "2.0",
  "method": "notifications/tools/list_changed"
}

# Client responds by refreshing tool list
await session.list_tools()  # Get updated tools
```

## Začíname: Krok za krokom

### Krok 1: Nastavenie prostredia

Nainštalujte potrebné závislosti:
```bash
pip install fastmcp mcp-python-client openai requests pyautogui Pillow
```

### Krok 2: Základná konfigurácia

Nastavte svoje environmentálne premenné:
```python
# System Configuration
SYSTEM_PROMPT = "You are an AI assistant with some tools."

# Ollama Configuration (Local)
OLLAMA_URL = "http://localhost:11434/api/chat"
OLLAMA_MODEL_ID = "phi4-mini:3.8b-fp16"

# vLLM Configuration (Server)
VLLM_URL = "http://localhost:8000/v1"
VLLM_MODEL_ID = "microsoft/Phi-4-mini-instruct"
```

### Krok 3: Spustenie vášho prvého MCP klienta

**Základné nastavenie Ollama:**
```bash
python ghmodel_mcp_demo.py
```

**Použitie vLLM backendu:**
```bash
python ghmodel_mcp_demo.py --env vllm
```

**Pripojenie Server-Sent Events:**
```bash
python ghmodel_mcp_demo.py --run sse
```

**Vlastný MCP server:**
```bash
python ghmodel_mcp_demo.py --server /path/to/server.py
```

### Krok 4: Programové použitie

```python
import asyncio
from ghmodel_mcp_demo import OllamaClient, Phi4MiniMCPClient

async def automated_interaction():
    # Configure MCP server parameters
    server_params = StdioServerParameters(
        command="npx",
        args=["@playwright/mcp@latest"],
        env=None,
    )
    
    # Create MCP client and process tools
    async with Phi4MiniMCPClient(server_params) as mcp_client:
        tools = await process_mcp_tools(mcp_client)
        llm_client = OllamaClient()
        
        # Generate response with tool capabilities
        response, messages = await llm_client.generate_response(
            "Help me automate a web task",
            tools
        )
        return response

# Execute the automation
result = asyncio.run(automated_interaction())
print(result)
```

## Pokročilé funkcie

### Podpora viacerých backendov

Implementácia podporuje backendy Ollama aj vLLM, čo vám umožňuje vybrať si podľa vašich požiadaviek:

- **Ollama**: Lepšie pre lokálny vývoj a testovanie
- **vLLM**: Optimalizované pre produkciu a scenáre s vysokou priepustnosťou

### Flexibilné protokoly pripojenia

Podporované sú dva režimy pripojenia:

**Režim STDIO**: Priama komunikácia procesov
- Nižšia latencia
- Vhodné pre lokálne nástroje
- Jednoduché nastavenie

**Režim SSE**: Streamovanie založené na HTTP
- Schopné pracovať v sieti
- Lepšie pre distribuované systémy
- Aktualizácie v reálnom čase

### Schopnosti integrácie nástrojov

Systém dokáže integrovať rôzne nástroje:
- Webová automatizácia (Playwright)
- Operácie so súbormi
- Interakcie s API
- Systémové príkazy
- Vlastné funkcie

## Správa chýb a osvedčené postupy

### Komplexná správa chýb

Implementácia zahŕňa robustnú správu chýb pre:

**Chyby pripojenia:**
- Zlyhania MCP servera
- Časové limity siete
- Problémy s konektivitou

**Chyby vykonávania nástrojov:**
- Chýbajúce nástroje
- Validácia parametrov
- Zlyhania vykonávania

**Chyby spracovania odpovedí:**
- Problémy s parsovaním JSON
- Nekonzistencie formátu
- Anomálie odpovedí LLM

### Osvedčené postupy

1. **Správa zdrojov**: Používajte asynchrónne správce kontextu
2. **Správa chýb**: Implementujte komplexné bloky try-catch
3. **Logovanie**: Aktivujte vhodné úrovne logovania
4. **Bezpečnosť**: Validujte vstupy a sanitizujte výstupy
5. **Výkon**: Používajte pooling pripojení a caching

## Aplikácie v reálnom svete

### Webová automatizácia
```python
# Example: Automated web testing
async def web_automation_example():
    tools = await setup_playwright_tools()
    response = await llm_client.generate_response(
        "Navigate to example.com and take a screenshot",
        tools
    )
```

### Spracovanie dát
```python
# Example: File analysis
async def data_processing_example():
    tools = await setup_file_tools()
    response = await llm_client.generate_response(
        "Analyze the CSV file and generate a summary report",
        tools
    )
```

### Integrácia API
```python
# Example: API interactions
async def api_integration_example():
    tools = await setup_api_tools()
    response = await llm_client.generate_response(
        "Fetch weather data and create a forecast summary",
        tools
    )
```

## Optimalizácia výkonu

### Správa pamäte
- Efektívne spracovanie histórie správ
- Správne čistenie zdrojov
- Pooling pripojení

### Optimalizácia siete
- Asynchrónne HTTP operácie
- Konfigurovateľné časové limity
- Plynulé zotavenie po chybách

### Súbežné spracovanie
- Neblokujúce I/O
- Paralelné vykonávanie nástrojov
- Efektívne asynchrónne vzory

## Bezpečnostné úvahy

### Ochrana dát
- Bezpečná správa API kľúčov
- Validácia vstupov
- Sanitizácia výstupov

### Sieťová bezpečnosť
- Podpora HTTPS
- Predvolené lokálne endpointy
- Bezpečná manipulácia s tokenmi

### Bezpečnosť vykonávania
- Filtrovanie nástrojov
- Sandboxované prostredia
- Audit logovanie

## Ekosystém MCP a vývoj

### Rozsah projektu MCP

Ekosystém Model Context Protocol zahŕňa niekoľko kľúčových komponentov:

- **[Špecifikácia MCP](https://modelcontextprotocol.io/specification/latest)**: Oficiálna špecifikácia definujúca požiadavky na implementáciu klientov a serverov
- **[MCP SDKs](https://modelcontextprotocol.io/docs/sdk)**: SDK pre rôzne programovacie jazyky, ktoré implementujú MCP
- **Vývojové nástroje MCP**: Nástroje na vývoj MCP serverov a klientov, vrátane [MCP Inspector](https://github.com/modelcontextprotocol/inspector)
- **[Referenčné implementácie MCP serverov](https://github.com/modelcontextprotocol/servers)**: Referenčné implementácie MCP serverov

### Začíname s vývojom MCP

Ak chcete začať budovať s MCP:

**Budovanie serverov**: [Vytvorte MCP servery](https://modelcontextprotocol.io/docs/develop/build-server), ktoré sprístupnia vaše dáta a nástroje

**Budovanie klientov**: [Vyvíjajte aplikácie](https://modelcontextprotocol.io/docs/develop/build-client), ktoré sa pripájajú k MCP serverom

**Učenie konceptov**: [Pochopte základné koncepty](https://modelcontextprotocol.io/docs/learn/architecture) a architektúru MCP

## Záver

SLMs integrované s MCP predstavujú posun v paradigme vývoja AI aplikácií. Kombináciou efektívnosti malých modelov s výkonom externých nástrojov môžu vývojári vytvárať inteligentné systémy, ktoré sú zároveň efektívne z hľadiska zdrojov a mimoriadne schopné.

Model Context Protocol poskytuje štandardizovaný spôsob pripojenia AI aplikácií k externým systémom, podobne ako USB-C poskytuje univerzálny štandard pripojenia pre elektronické zariadenia. Táto štandardizácia umožňuje:

- **Bezproblémovú integráciu**: Pripojenie AI modelov k rôznym dátovým zdrojom a nástrojom
- **Rast ekosystému**: Raz vybudované, použiteľné naprieč viacerými AI aplikáciami
- **Rozšírené schopnosti**: Rozšírenie SLMs o externú funkcionalitu
- **Aktualizácie v reálnom čase**: Podpora dynamických, responzívnych AI aplikácií

Kľúčové poznatky:
- MCP je otvorený štandard, ktorý prepája AI aplikácie a externé systémy
- Protokol podporuje nástroje, zdroje a výzvy ako základné prvky
- Notifikácie v reálnom čase umožňujú dynamické, responzívne aplikácie
- Správna správa životného cyklu a správa chýb sú nevyhnutné pre produkčné použitie
- Ekosystém poskytuje komplexné SDK a vývojové nástroje

## Referencie a ďalšie čítanie

### Oficiálna dokumentácia MCP

- **[Oficiálna stránka Model Context Protocol](https://modelcontextprotocol.io/)** - Kompletná dokumentácia a špecifikácie
- **[Príručka Začíname s MCP](https://modelcontextprotocol.io/docs/getting-started/intro)** - Úvod a základné koncepty
- **[Prehľad architektúry MCP](https://modelcontextprotocol.io/docs/learn/architecture)** - Detailná technická architektúra
- **[Špecifikácia MCP](https
- **[Ollama Dokumentácia](https://ollama.ai/docs)** - Platforma na lokálne nasadenie LLM
- **[vLLM Dokumentácia](https://docs.vllm.ai/)** - Vysoko výkonné poskytovanie LLM

### Technické štandardy a protokoly

- **[JSON-RPC 2.0 Špecifikácia](https://www.jsonrpc.org/)** - Základný RPC protokol používaný MCP
- **[JSON Schema](https://json-schema.org/)** - Štandard na definovanie schém pre nástroje MCP
- **[OpenAPI Špecifikácia](https://swagger.io/specification/)** - Štandard pre dokumentáciu API
- **[Server-Sent Events (SSE)](https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events)** - Webový štandard pre aktualizácie v reálnom čase

### Vývoj AI agentov

- **[Microsoft Agent Framework](https://github.com/microsoft/agent-framework)** - Vývoj agentov pripravených na produkciu
- **[LangChain Dokumentácia](https://docs.langchain.com/)** - Rámec na integráciu agentov a nástrojov
- **[Semantic Kernel](https://learn.microsoft.com/en-us/semantic-kernel/)** - SDK od Microsoftu na orchestráciu AI

### Priemyselné správy a výskum

- **[Oznámenie o Model Context Protocol od Anthropic](https://www.anthropic.com/news/model-context-protocol)** - Pôvodné predstavenie MCP
- **[Prieskum malých jazykových modelov](https://arxiv.org/abs/2410.20011)** - Akademický prieskum výskumu SLM
- **[Analýza trhu Edge AI](https://www.marketsandmarkets.com/Market-Reports/edge-ai-software-market-74385617.html)** - Trendy a prognózy v priemysle
- **[Najlepšie postupy vo vývoji AI agentov](https://arxiv.org/abs/2309.02427)** - Výskum architektúr agentov

Táto sekcia poskytuje základy na vytvorenie vlastných aplikácií MCP poháňaných SLM, čím otvára možnosti pre automatizáciu, spracovanie dát a integráciu inteligentných systémov.

## ➡️ Čo ďalej

- [Modul 7. Príklady Edge AI](../Module07/README.md)

---

**Zrieknutie sa zodpovednosti**:  
Tento dokument bol preložený pomocou služby AI prekladu [Co-op Translator](https://github.com/Azure/co-op-translator). Hoci sa snažíme o presnosť, prosím, berte na vedomie, že automatizované preklady môžu obsahovať chyby alebo nepresnosti. Pôvodný dokument v jeho rodnom jazyku by mal byť považovaný za autoritatívny zdroj. Pre kritické informácie sa odporúča profesionálny ľudský preklad. Nenesieme zodpovednosť za akékoľvek nedorozumenia alebo nesprávne interpretácie vyplývajúce z použitia tohto prekladu.