<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "a534c7d108d29f908a8f9f693d694664",
  "translation_date": "2025-12-15T22:08:31+00:00",
  "source_file": "Module08/05.AIPoweredAgents.md",
  "language_code": "ml"
}
-->
# เดธเตเดทเตป 5: Foundry Local เดเดชเดฏเตเดเดฟเดเตเดเต เดเด-เดชเดตเตผเดกเต เดเดเดจเตเดฑเตเดเตพ เดตเตเดเดคเตเดคเดฟเตฝ เดจเดฟเตผเดฎเตเดฎเดฟเดเตเดเตเด

เดเตเดฑเดฟเดชเตเดชเต: Foundry Local-เดฏเดฟเดฒเต เดเดเดจเตเดฑเต เดถเตเดทเดฟเดเตพ เดตเดฟเดเดธเดฟเดเตเดเตเดจเตเดจเตโเดเดกเตเดตเดพเตปเดธเตเดกเต เดชเดพเดฑเตเดฑเตเดฃเตเดเตพ เดจเดเดชเตเดชเดฟเดฒเดพเดเตเดเตเดจเตเดจเดคเดฟเดจเต เดฎเตเดฎเตเดชเต เดเดฑเตเดฑเดตเตเด เดชเตเดคเดฟเดฏ เดฑเดฟเดฒเตเดธเต เดจเตเดเตเดเตเดเดณเดฟเตฝ เดชเดฟเดจเตเดคเตเดฃ เดธเตเดฅเดฟเดฐเตเดเดฐเดฟเดเตเดเตเด.

## เดเดตเดฒเตเดเดจเด

Foundry Local เดเดชเดฏเตเดเดฟเดเตเดเต เดเดเดจเตเดฑเดฟเดเต เดเดชเตเดฒเดฟเดเตเดเตเดทเดจเตเดเตพ เดตเตเดเดคเตเดคเดฟเตฝ เดชเตเดฐเตเดเตเดเตเดเตเดชเตเดชเต เดเตเดฏเตเดฏเตเด: เดธเดฟเดธเตเดฑเตเดฑเด เดชเตเดฐเตเดเดชเตเดฑเตเดฑเตเดเตพ, เดเตเดฐเตเดฃเตเดเดฟเดเดเต, เดเตผเดเตเดเดธเตเดเตเดฐเตเดทเตป เดชเดพเดฑเตเดฑเตเดฃเตเดเตพ. เดเดเดจเตเดฑเต เดชเดฟเดจเตเดคเตเดฃ เดเดฃเตเดเดพเดฏเดพเตฝ, OpenAI-เดธเดฎเตผเดคเตเดฅเดฎเดพเดฏ เดซเดเดเตเดทเตป เดเตเตพ เดเตเดฏเตเดฏเตฝ เดธเตเดฑเตเดฑเดพเตปเดกเตผเดกเตเดธเต เดเตเดฏเตเดฏเดพเด เดเดฒเตเดฒเตเดเตเดเดฟเตฝ เดนเตเดฌเตเดฐเดฟเดกเต เดกเดฟเดธเตเดจเตเดเดณเดฟเตฝ เดเตเดฒเตเดกเต เดญเดพเดเดคเตเดคเต Azure AI เดเดเดจเตเดฑเตเดเตพ เดเดชเดฏเตเดเดฟเดเตเดเดพเด.

> **๐ เดเดงเตเดจเดฟเด SDK-เดเตเดเดพเดฏเดฟ เดเดชเตเดกเตเดฑเตเดฑเต เดเตเดฏเตเดคเต**: เด เดฎเตเดกเตเดฏเตเตพ เดเดฑเตเดฑเดตเตเด เดชเตเดคเดฟเดฏ Microsoft Foundry-Local เดฑเดฟเดชเตเดธเดฟเดฑเตเดฑเดฑเดฟ เดชเดพเดฑเตเดฑเตเดฃเตเดเดณเตเดฎเดพเดฏเดฟ เดชเตเดฐเตเดคเตเดคเดชเตเดชเตเดเตเดจเตเดจเต, `samples/05/`-เตฝ เดธเดฎเดเตเดฐเดฎเดพเดฏ เดจเดเดชเตเดชเดฟเดฒเดพเดเตเดเดฒเดฟเดจเตเดชเตเดชเด. เดเดฆเดพเดนเดฐเดฃเดเตเดเตพ เดเดชเตเดชเตเตพ เดฎเดพเดจเตเดตเตฝ เดเดญเตเดฏเตผเดคเตเดฅเดจเดเดณเตเดเต เดชเดเดฐเด เดเดงเตเดจเดฟเด `foundry-local-sdk`เดฏเตเด `OpenAI` เดเตเดฒเดฏเดจเตเดฑเตเด เดเดชเดฏเตเดเดฟเดเตเดเตเดจเตเดจเต.

**๐๏ธ เดเตผเดเตเดเดฟเดเตเดเตเดเตผ เดนเตเดฒเตเดฑเตเดฑเตเดเตพ:**
- **เดธเตเดชเตเดทเตเดฏเดฒเดฟเดธเตเดฑเตเดฑเต เดเดเดจเตเดฑเตเดเตพ**: เดตเตเดฏเดคเตเดฏเดธเตเดค เดถเตเดทเดฟเดเดณเตเดณเตเดณ เดฑเดฟเดเตเดฐเตเดตเตฝ, เดฑเตเดธเดฃเดฟเดเดเต, เดเดเตเดธเดฟเดเตเดฏเตเดทเตป เดเดเดจเตเดฑเตเดเตพ
- **เดเตเดเตผเดกเดฟเดจเตเดฑเตเดฑเตผ เดชเดพเดฑเตเดฑเตเตบ**: เดซเตเดกเตเดฌเดพเดเตเดเต เดฒเตเดชเตเดชเตเดเดณเตเดเต เดฎเตพเดเตเดเดฟ-เดเดเดจเตเดฑเต เดตเตผเดเตเดเตโเดซเตเดฒเตเดเตพ เดเตผเดเตเดเดธเตเดเตเดฐเตเดฑเตเดฑเต เดเตเดฏเตเดฏเตเดจเตเดจเต
- **เดเดงเตเดจเดฟเด SDK เดเดจเตเดฑเดเตเดฐเตเดทเตป**: `FoundryLocalManager`เดฏเตเด OpenAI เดเตเดฒเดฏเดจเตเดฑเตเด เดเดชเดฏเตเดเดฟเดเตเดเตเดจเตเดจเต
- **เดชเตเดฐเตเดกเดเตเดทเตป เดฑเตเดกเดฟ**: เดชเดฟเดถเดเต เดเตเดเดพเดฐเตเดฏเด, เดชเตเดฐเดเดเดจ เดจเดฟเดฐเตเดเตเดทเดฃเด, เดนเตเตฝเดคเตเดคเต เดเตเดเตเดเตเดเตพ เดเตพเดชเตเดชเตเดเตเดจเตเดจเต
- **เดธเดฎเดเตเดฐ เดเดฆเดพเดนเดฐเดฃเดเตเดเตพ**: เดเดกเตเดตเดพเตปเดธเตเดกเต เดซเตเดเตเดเดฑเตเดเดณเตเดณเตเดณ เดเดจเตเดฑเดฑเดพเดเตเดเตเดตเต Jupyter เดจเตเดเตเดเตโเดฌเตเดเตเดเต

**๐ เดฒเตเดเตเดเตฝ เดจเดเดชเตเดชเดฟเดฒเดพเดเตเดเตฝ:**
- `samples/05/multi_agent_orchestration.ipynb` - เดเดจเตเดฑเดฑเดพเดเตเดเตเดตเต เดเดฆเดพเดนเดฐเดฃเดเตเดเดณเตเด เดฌเตเดเตเดเตเดฎเดพเตผเดเตเดเตเดเดณเตเด
- `samples/05/agents/specialists.py` - เดเดเดจเตเดฑเต เดจเดเดชเตเดชเดฟเดฒเดพเดเตเดเดฒเตเดเตพ
- `samples/05/agents/coordinator.py` - เดเตผเดเตเดเดธเตเดเตเดฐเตเดทเตป เดฒเดเดฟเดเต

เดฑเดซเดฑเตปเดธเตเดเตพ:
- Foundry Local เดกเตเดเตเดธเต: https://learn.microsoft.com/en-us/azure/ai-foundry/foundry-local/
- Azure AI Foundry เดเดเดจเตเดฑเตเดเตพ: https://learn.microsoft.com/en-us/azure/ai-services/agents/overview
- เดซเดเดเตเดทเตป เดเตเตพ เดเตเดฏเตเดฏเตฝ เดธเดพเดฎเตเดชเดฟเตพ (Foundry Local เดธเดพเดฎเตเดชเดฟเตพเดธเต): https://github.com/microsoft/Foundry-Local/tree/main/samples/python/functioncalling

## เดชเดเดจ เดฒเดเตเดทเตเดฏเดเตเดเตพ
- เดตเดฟเดถเตเดตเดธเดจเตเดฏเดฎเดพเดฏ เดชเตเดฐเตเดฎเดพเดฑเตเดฑเดคเตเดคเดฟเดจเดพเดฏเดฟ เดธเดฟเดธเตเดฑเตเดฑเด เดชเตเดฐเตเดเดชเตเดฑเตเดฑเตเดเดณเตเด เดเตเดฐเตเดฃเตเดเดฟเดเดเต เดคเดจเตเดคเตเดฐเดเตเดเดณเตเด เดฐเตเดชเดเตฝเดชเตเดชเดจ เดเตเดฏเตเดฏเตเด
- เดซเดเดเตเดทเตป เดเตเตพ เดเตเดฏเตเดฏเตฝ (เดเตเตพ เดเดชเดฏเตเดเด) เดชเดพเดฑเตเดฑเตเดฃเตเดเตพ เดจเดเดชเตเดชเดฟเดฒเดพเดเตเดเตเด
- เดฎเตพเดเตเดเดฟ-เดเดเดจเตเดฑเต เดตเตผเดเตเดเตโเดซเตเดฒเตเดเตพ เดเตผเดเตเดเดธเตเดเตเดฐเตเดฑเตเดฑเต เดเตเดฏเตเดฏเตเด (เดฒเตเดเตเดเตฝ, เดนเตเดฌเตเดฐเดฟเดกเต)
- เดจเดฟเดฐเตเดเตเดทเดฃเดตเตเด เดธเตเดฐเดเตเดทเดฏเตเด เดชเดฆเตเดงเดคเดฟเดฏเดฟเดเตเด

## เดญเดพเดเด 1: เดธเดฟเดธเตเดฑเตเดฑเด เดชเตเดฐเตเดเดชเตเดฑเตเดฑเตเดเดณเตเด เดเตเดฐเตเดฃเตเดเดฟเดเดเตเด

- เดเตผเดถเดจเดฎเดพเดฏ เดฑเตเดณเตเดเตพ, เดจเดฟเดฏเดจเตเดคเตเดฐเดฃเดเตเดเตพ, เดเดเตเดเตเดชเตเดเตเดเต เดธเตเดเตเดฎเดเตพ เดจเดฟเตผเดตเดเดฟเดเตเดเตเด
- เดฒเตเดเตเดเตฝ เดเดฒเตเดฒเตเดเตเดเดฟเตฝ เดเดจเตเดฑเตผเดชเตเดฐเตเดธเต เดกเดพเดฑเตเดฑ เดเดชเดฏเตเดเดฟเดเตเดเต เดชเตเดฐเดคเดฟเดเดฐเดฃเดเตเดเตพ เดเตเดฐเตเดฃเตเดเต เดเตเดฏเตเดฏเตเด
- เดกเตเตบเดธเตเดเตเดฐเตเด เดเดเตเดเตเดฎเตเดทเตปเดเตเดเดพเดฏเดฟ JSON เดเดเตเดเตเดชเตเดเตเดเตเดเตพ เดจเดฟเตผเดฌเดจเตเดงเดฟเดเตเดเตเด

## เดญเดพเดเด 2: เดซเดเดเตเดทเตป เดเตเตพ เดเตเดฏเตเดฏเตฝ (เดเดงเตเดจเดฟเด SDK เดธเดฎเตเดชเดจเด)

```python
# tools.py
import json
from typing import List, Dict, Any

def get_weather(city: str) -> str:
    return f"Weather in {city}: Sunny, 25C"

# OpenAI API-เดเตเดเตเดณเตเดณ เดเดงเตเดจเดฟเด เดเตเตพเดธเต เดซเตเตผเดฎเดพเดฑเตเดฑเต
TOOLS = [
    {
        "type": "function",
        "function": {
            "name": "get_weather",
            "description": "Get current weather for a city",
            "parameters": {
                "type": "object",
                "properties": {
                    "city": {"type": "string", "description": "City name"}
                },
                "required": ["city"]
            }
        }
    }
]
```

```python
# agent.py
from foundry_local import FoundryLocalManager
from openai import OpenAI
import json
from tools import TOOLS, get_weather

# เดซเตเดฃเตเดเตเดฐเดฟ เดฒเตเดเตเดเตฝ เดฎเดพเดจเตเดเตผ เดเดฐเดเดญเดฟเดเตเดเตเด
alias = "phi-4-mini"
manager = FoundryLocalManager(alias)

# เดซเตเดฃเตเดเตเดฐเดฟ เดฒเตเดเตเดเตฝ เดเตปเดกเตโเดชเตเดฏเดฟเดจเตเดฑเต เดเดชเดฏเตเดเดฟเดเตเดเต OpenAI เดเตเดฒเดฏเดจเตเดฑเต เดธเตเดทเตเดเดฟเดเตเดเตเด
client = OpenAI(
    base_url=manager.endpoint,
    api_key=manager.api_key
)

SYSTEM_PROMPT = "You are a helpful assistant. Use tools when needed."

def process_function_call(messages: List[Dict], tools: List[Dict]) -> str:
    """Process function calling with modern OpenAI API."""
    try:
        response = client.chat.completions.create(
            model=manager.get_model_info(alias).id,
            messages=messages,
            tools=tools,
            tool_choice="auto"
        )
        
        message = response.choices[0].message
        
        if message.tool_calls:
            # เดซเดเดเตเดทเตป เดเตเตพเดธเต เดเตเดเดพเดฐเตเดฏเด เดเตเดฏเตเดฏเตเด
            messages.append(message)
            
            for tool_call in message.tool_calls:
                if tool_call.function.name == "get_weather":
                    args = json.loads(tool_call.function.arguments)
                    result = get_weather(args["city"])
                    
                    # เดซเดเดเตเดทเตป เดซเดฒเด เดธเดจเตเดฆเตเดถเดเตเดเดณเดฟเตฝ เดเตเตผเดเตเดเตเด
                    messages.append({
                        "role": "tool",
                        "tool_call_id": tool_call.id,
                        "content": result
                    })
            
            # เดเดจเตเดคเดฟเดฎ เดชเตเดฐเดคเดฟเดเดฐเดฃเด เดจเตเดเตเด
            final_response = client.chat.completions.create(
                model=manager.get_model_info(alias).id,
                messages=messages
            )
            return final_response.choices[0].message.content
        else:
            return message.content
            
    except Exception as e:
        return f"Error: {str(e)}"

# เดเดฆเดพเดนเดฐเดฃ เดเดชเดฏเตเดเด
messages = [
    {"role": "system", "content": SYSTEM_PROMPT},
    {"role": "user", "content": "What's the weather in Paris?"}
]

result = process_function_call(messages, TOOLS)
print(result)
```

เดเดเดฟเดเตเดเตเด:
```powershell
# เดฎเตเดกเดฒเตเดฎเดพเดฏเดฟ เดซเตเดฃเตเดเตเดฐเดฟ เดฒเตเดเตเดเตฝ เดชเตเดฐเดตเตผเดคเตเดคเดฟเดเตเดเตเดจเตเดจเตเดฃเตเดเตเดจเตเดจเต เดเดฑเดชเตเดชเดพเดเตเดเตเด
foundry model run phi-4-mini
python agent.py
```

## เดญเดพเดเด 3: เดฎเตพเดเตเดเดฟ-เดเดเดจเตเดฑเต เดเตผเดเตเดเดธเตเดเตเดฐเตเดทเตป (เดชเดพเดฑเตเดฑเตเตบ)

Foundry Local-เดจเตเดฑเต OpenAI-เดธเดฎเตผเดคเตเดฅเดฎเดพเดฏ เดเดจเตเดฑเตเดชเตเดฏเดฟเดจเตเดฑเต เดเดชเดฏเตเดเดฟเดเตเดเต เดธเตเดชเตเดทเตเดฏเดฒเดฟเดธเตเดฑเตเดฑเต เดเดเดจเตเดฑเตเดเตพ (เดฑเดฟเดเตเดฐเตเดตเตฝ, เดฑเตเดธเดฃเดฟเดเดเต, เดเดเตเดธเดฟเดเตเดฏเตเดทเตป) เดเดพเดธเตเดเตเดเตพ เดฑเตเดเตเดเตเดเตเดฏเตเดฏเตเดจเตเดจ เดเตเดเตผเดกเดฟเดจเตเดฑเตเดฑเตผ เดฐเตเดชเดเตฝเดชเตเดชเดจ เดเตเดฏเตเดฏเตเด.

เดชเดเดฟ 1) เดเดงเตเดจเดฟเด SDK เดเดชเดฏเตเดเดฟเดเตเดเต เดธเตเดชเตเดทเตเดฏเดฒเดฟเดธเตเดฑเตเดฑเต เดเดเดจเตเดฑเตเดเตพ เดจเดฟเตผเดตเดเดฟเดเตเดเตเด (`samples/05/agents/specialists.py` เดเดพเดฃเตเด)
```python
# เดเดเดจเตเดฑเตเดเตพ/เดตเดฟเดถเตเดทเดเตเดเตผ.py
from foundry_local import FoundryLocalManager
from openai import OpenAI
from typing import List, Dict, Any

class FoundryClient:
    """Shared client for all specialist agents."""
    
    def __init__(self, model_alias: str = "phi-4-mini"):
        self.client = None
        self.model_name = None
        self.model_alias = model_alias
        self._initialize_client()
    
    def _initialize_client(self):
        """Initialize OpenAI client with Foundry Local."""
        try:
            manager = FoundryLocalManager(self.model_alias)
            model_info = manager.get_model_info(self.model_alias)
            
            self.client = OpenAI(
                base_url=manager.endpoint,
                api_key=manager.api_key
            )
            self.model_name = model_info.id
            print(f"โ Foundry Local initialized with model: {self.model_name}")
        except Exception as e:
            print(f"โ Error initializing Foundry Local: {e}")
            raise
    
    def chat(self, messages: List[Dict[str, str]], max_tokens: int = 300, temperature: float = 0.4) -> str:
        """Send chat completion request to the model."""
        try:
            response = self.client.chat.completions.create(
                model=self.model_name,
                messages=messages,
                max_tokens=max_tokens,
                temperature=temperature
            )
            return response.choices[0].message.content
        except Exception as e:
            return f"Error generating response: {str(e)}"

# เดเดเตเดณ เดเตเดฒเดฏเดจเตเดฑเต เดเตปเดธเตเดฑเตเดฑเตปเดธเต
_client = FoundryClient()

class RetrievalAgent:
    """Agent specialized in retrieving relevant information from knowledge sources."""
    
    SYSTEM = """You are a specialized retrieval agent. Your job is to extract and retrieve 
    the most relevant information from knowledge sources based on a given query. Focus on key facts, 
    data points, and contextual information that would be useful for decision-making."""
    
    def run(self, query: str) -> str:
        """Retrieve relevant information based on the query."""
        messages = [
            {"role": "system", "content": self.SYSTEM},
            {"role": "user", "content": f"Query: {query}\n\nRetrieve the most relevant key facts, data points, and contextual information that would help answer this query or support decision-making around it."}
        ]
        return _client.chat(messages)

class ReasoningAgent:
    """Agent specialized in step-by-step analysis and reasoning."""
    
    SYSTEM = """You are a specialized reasoning agent. Your job is to analyze inputs 
    step-by-step and produce structured, logical conclusions. Break down complex problems 
    into manageable parts and provide clear reasoning for your conclusions."""
    
    def run(self, context: str, question: str) -> str:
        """Analyze context and question to produce structured conclusions."""
        messages = [
            {"role": "system", "content": self.SYSTEM},
            {"role": "user", "content": f"Context:\n{context}\n\nQuestion: {question}\n\nAnalyze this step-by-step and provide a structured, logical conclusion with clear reasoning."}
        ]
        return _client.chat(messages, max_tokens=400)

class ExecutionAgent:
    """Agent specialized in creating actionable execution plans."""
    
    SYSTEM = """You are a specialized execution agent. Your job is to transform decisions 
    and conclusions into concrete, actionable steps. Always format your response as valid JSON 
    with an array of action items. Each action should be specific, measurable, and achievable."""
    
    def run(self, decision: str) -> str:
        """Transform decision into actionable steps in JSON format."""
        messages = [
            {"role": "system", "content": self.SYSTEM},
            {"role": "user", "content": f"Decision/Conclusion:\n{decision}\n\nCreate 3-5 specific, actionable steps to implement this decision. Format as JSON with this structure:\n{{\"actions\": [{{\"step\": 1, \"description\": \"...\", \"priority\": \"high/medium/low\", \"timeline\": \"...\"}}]}}"}
        ]
        return _client.chat(messages, max_tokens=400, temperature=0.3)
```

เดชเดเดฟ 2) เดเดกเตเดตเดพเตปเดธเตเดกเต เดซเตเดเตเดเดฑเตเดเดณเตเดเต เดเตเดเตผเดกเดฟเดจเตเดฑเตเดฑเตผ เดจเดฟเตผเดฎเตเดฎเดฟเดเตเดเตเด
```python
# เดเดเดจเตเดฑเตเดเตพ/เดเตเดเตผเดกเดฟเดจเตเดฑเตเดฑเตผ.py
from .specialists import RetrievalAgent, ReasoningAgent, ExecutionAgent
from typing import Dict, Any
import time
import json

class Coordinator:
    """Multi-agent coordinator that orchestrates specialist agents to handle complex tasks."""
    
    def __init__(self):
        """Initialize the coordinator with specialist agents."""
        self.retrieval = RetrievalAgent()
        self.reasoning = ReasoningAgent()
        self.execution = ExecutionAgent()
    
    def handle(self, user_goal: str) -> Dict[str, Any]:
        """
        Orchestrate multiple agents to handle a complex user goal.
        
        Args:
            user_goal: The user's high-level goal or request
            
        Returns:
            Dictionary containing the goal, context, decision, and actions
        """
        print(f"๐ฏ **Coordinator:** Processing goal: {user_goal}")
        print("=" * 60)
        
        start_time = time.time()
        
        # เดเดเตเดเด 1: เดฌเดจเตเดงเดชเตเดชเตเดเตเด เดธเดพเดจเตเดฆเตผเดญเตเดฏเด เดชเตเดจเดเดชเตเดฐเดพเดชเดฟเดเตเดเตเด
        print("๐ **Step 1:** Retrieving context...")
        context = self.retrieval.run(user_goal)
        print(f"   โ Context retrieved ({len(context)} chars)")
        
        # เดเดเตเดเด 2: เดธเดพเดจเตเดฆเตผเดญเตเดฏเด เดตเดฟเดถเดเดฒเดจเด เดเตเดฏเตเดคเต เดเดพเดฐเดฃเดตเดคเตเดเดฐเดฃเด เดจเดเดคเตเดคเตเด
        print("๐ง **Step 2:** Analyzing and reasoning...")
        decision = self.reasoning.run(context, user_goal)
        print(f"   โ Analysis completed ({len(decision)} chars)")
        
        # เดเดเตเดเด 3: เดชเตเดฐเดตเตผเดคเตเดคเดจเดฏเตเดเตเดฏเดฎเดพเดฏ เดจเดเดชเตเดชเดพเดเตเดเตฝ เดชเดฆเตเดงเดคเดฟ เดธเตเดทเตเดเดฟเดเตเดเตเด
        print("โก **Step 3:** Creating execution plan...")
        actions = self.execution.run(decision)
        print(f"   โ Execution plan created ({len(actions)} chars)")
        
        end_time = time.time()
        processing_time = end_time - start_time
        
        result = {
            "goal": user_goal,
            "context": context,
            "decision": decision,
            "actions": actions,
            "agent_flow": ["retrieval", "reasoning", "execution"],
            "processing_time": processing_time,
            "timestamp": time.strftime("%Y-%m-%d %H:%M:%S")
        }
        
        print(f"โ **Coordination Complete** (โฑ๏ธ {processing_time:.2f}s)")
        return result
    
    def handle_with_feedback(self, user_goal: str, feedback_rounds: int = 1) -> Dict[str, Any]:
        """
        Handle a goal with multiple feedback rounds for refinement.
        
        Args:
            user_goal: The user's high-level goal or request
            feedback_rounds: Number of feedback rounds to perform
            
        Returns:
            Dictionary containing the refined result
        """
        result = self.handle(user_goal)
        
        for round_num in range(feedback_rounds):
            print(f"\n๐ **Feedback Round {round_num + 1}:**")
            print("-" * 40)
            
            # เดจเดเดชเตเดชเดพเดเตเดเตฝ เดชเดฆเตเดงเดคเดฟ เดฎเตเดเตเดเดชเตเดชเตเดเตเดคเตเดคเดพเตป เดเดพเดฐเดฃเดตเดคเตเดเดฐเดฃ เดเดเดจเตเดฑเต เดเดชเดฏเตเดเดฟเดเตเดเตเด
            refinement_prompt = f"""
            Original Goal: {user_goal}
            Current Decision: {result['decision']}
            Current Actions: {result['actions']}
            
            Review the above and suggest improvements or refinements to make the execution plan more effective.
            """
            
            refined_decision = self.reasoning.run(result['context'], refinement_prompt)
            refined_actions = self.execution.run(refined_decision)
            
            result['decision'] = refined_decision
            result['actions'] = refined_actions
            result['refinement_rounds'] = round_num + 1
            
            print(f"   โ Round {round_num + 1} refinement completed")
        
        return result

def main():
    """Main function demonstrating the multi-agent coordinator."""
    print("๐ค **Multi-Agent Coordinator Demo**")
    print("=" * 50)
    
    # เดเตเดเตผเดกเดฟเดจเตเดฑเตเดฑเตผ เดธเตเดทเตเดเดฟเดเตเดเตเด
    coord = Coordinator()
    
    # เดเดฆเดพเดนเดฐเดฃ เดฒเดเตเดทเตเดฏเดเตเดเตพ
    example_goals = [
        "Create a plan to onboard 5 new customers this month",
        "Develop a strategy to improve team productivity by 20%",
        "Design a customer feedback collection system"
    ]
    
    # เดชเตเดฐเดคเดฟเดเดฐเดฃเดคเตเดคเตเดเต เดเดฆเดพเดนเดฐเดฃ เดชเตเดฐเดเตเดฐเดฟเดฏ
    goal = example_goals[0]
    print(f"๐ฏ **Processing Goal:** {goal}")
    print("-" * 50)
    
    try:
        # เดเดเดฟเดธเตเดฅเดพเดจ เดชเตเดฐเตเดธเดธเตเดธเดฟเดเดเต
        result = coord.handle(goal)
        
        # เดชเตเดฐเดคเดฟเดเดฐเดฃ เดฎเตเดเตเดเดชเตเดชเตเดเตเดคเตเดคเดฒเตเดเต
        refined_result = coord.handle_with_feedback(goal, feedback_rounds=1)
        
        print("\n๐ **Final Result:**")
        print("=" * 50)
        print(f"**Goal:** {refined_result['goal']}")
        print(f"**Processing Time:** {refined_result['processing_time']:.2f}s")
        
        # เดชเตเดฐเดตเตผเดคเตเดคเดจเดเตเดเตพ JSON เดเดฏเดฟ เดชเดพเดดเตโเดธเต เดเตเดฏเตเดฏเดพเตป เดถเตเดฐเดฎเดฟเดเตเดเตเด
        try:
            actions_json = json.loads(refined_result['actions'])
            print(f"\n**Formatted Actions:**")
            print(json.dumps(actions_json, indent=2))
        except (json.JSONDecodeError, TypeError):
            print(f"\n**Actions:** {refined_result['actions']}")
            
    except Exception as e:
        print(f"โ **Error:** {e}")
        print("\nPlease ensure Foundry Local is running with a model loaded.")

if __name__ == "__main__":
    main()
```

เดชเดเดฟ 3) Foundry Local-เดจเตเดเต เดธเดพเดงเตเดค เดชเดฐเดฟเดถเตเดงเดฟเดเตเดเต เดธเดพเดฎเตเดชเดฟเตพเดธเต เดเดเดฟเดเตเดเตเด
```powershell
REM Confirm the local endpoint and model are available
foundry model list
foundry model run phi-4-mini
curl http://localhost:8000/v1/models

REM Run the coordinator from Module08 directory
cd Module08
python -m samples.05.agents.coordinator

REM Or explore the comprehensive Jupyter notebook
jupyter notebook samples/05/multi_agent_orchestration.ipynb
```

> **๐ เดฒเตเดเตเดเตฝ เดธเดพเดฎเตเดชเดฟเตพ เดฑเดซเดฑเตปเดธเตเดเตพ:**
> - **เดชเตเดฐเดงเดพเดจ เดจเดเดชเตเดชเดฟเดฒเดพเดเตเดเตฝ**: `samples/05/agents/specialists.py` & `samples/05/agents/coordinator.py`
> - **เดธเดฎเดเตเดฐ เดเดฆเดพเดนเดฐเดฃเดเตเดเตพ**: `samples/05/multi_agent_orchestration.ipynb`
> - **เดธเดเตเดเตเดเดฐเดฃ เดจเดฟเตผเดฆเตเดฆเตเดถเดเตเดเตพ**: `samples/05/README.md`
> 
> **๐ เดฌเดจเตเดงเดชเตเดชเตเดเตเด Foundry Local เดธเดพเดฎเตเดชเดฟเตพเดธเต:**
> - [เดซเดเดเตเดทเตป เดเตเตพ เดเตเดฏเตเดฏเตฝ เดธเดพเดฎเตเดชเดฟเตพ](https://github.com/microsoft/Foundry-Local/tree/main/samples/python/functioncalling)
> - [เดนเตเดฒเต Foundry Local](https://github.com/microsoft/Foundry-Local/tree/main/samples/python/hello-foundry-local)

เดจเดฟเตผเดฆเตเดฆเตเดถเดเตเดเตพ:
- เดเดเดจเตเดฑเตเดเตพเดเตเดเดฟเดเดฏเดฟเตฝ เดฑเดฟเดเตเดฐเตเดเดณเตเด เดเตเดเดเดเตเดเตเดเดณเตเด เดจเดเดชเตเดชเดฟเดฒเดพเดเตเดเตเด
- เดธเดเดญเดพเดทเดฃ/เดคเตเดฐเตเดกเต เดธเตเดฑเตเดฑเตเดฑเตเดฑเดฟเดจเดพเดฏเดฟ เดเตเดฑเดฟเดฏ เดเตป-เดฎเตเดฎเตเดฎเดฑเดฟ เดธเตเดฑเตเดฑเตเตผ (เดกเดฟเดเตเดทเดฃเดฑเดฟ) เดเตเตผเดเตเดเตเด
- เดฎเตพเดเตเดเดฟ เดเตเตพ เดเตเดฏเดฟเดจเดฟเดเดเต เดเตเดฏเตเดฏเตเดฎเตเดชเตเตพ เดฑเตเดฑเตเดฑเต-เดฒเดฟเดฎเดฟเดฑเตเดฑเดฟเดเดเต เดชเดฐเดฟเดเดฏเดชเตเดชเตเดเตเดคเตเดคเตเด

## เดญเดพเดเด 4: เดจเดฟเดฐเตเดเตเดทเดฃเดตเตเด เดธเตเดฐเดเตเดทเดฏเตเด

เดชเตเดฐเตเดเดชเตเดฑเตเดฑเตเดเดณเตเด เดชเตเดฐเดคเดฟเดเดฐเดฃเดเตเดเดณเตเด เดชเดฟเดถเดเตเดเดณเตเด เดฒเตเดเตเดเดฒเดพเดฏเดฟ เดเตเดฐเดพเดเตเดเต เดเตเดฏเตเดฏเตเด, เดเดเดจเตเดฑเต เดธเตเดฑเตเดฑเดพเดเตเดเดฟเตฝ เดกเดพเดฑเตเดฑ เดนเตเดเตเตป เดจเดฟเตผเดฌเดจเตเดงเดฟเดเตเดเตเด.

เดชเดเดฟ 1) เดฒเดเต เดญเดพเดฐเด เดเดญเตเดฏเตผเดคเตเดฅเดจ เดฒเตเดเดฟเดเดเต (เดเดเตเดเดฟเดเด)

เดเตเดฑเดฟเดชเตเดชเต: เดคเดพเดดเต เดเตเดเตเดคเตเดค เดนเตเตฝเดชเตเดชเตผ เดกเดฟเดซเตเตพเดเตเดเดพเดฏเดฟ เดเตพเดชเตเดชเตเดเตเดคเตเดคเดฟเดฏเดฟเดเตเดเดฟเดฒเตเดฒ. เดชเดฐเตเดเตเดทเดฃเดเตเดเตพเดเตเดเต เดฒเตเดเตเดเตฝ JSON เดฒเตเดเดฟเดเดเต เดตเตเดฃเตเดเตเดเตเดเดฟเตฝ `infra/obs.py` เดธเตเดทเตเดเดฟเดเตเดเตเด.
```python
# เดเตปเดซเตเดฐ/เดเดฌเตเดธเต.py
import time, json, os
from datetime import datetime

LOG_DIR = os.getenv("FOUNDRY_AGENT_LOG_DIR", "./agent_logs")
os.makedirs(LOG_DIR, exist_ok=True)

def log_event(kind: str, payload: dict):
    ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
    path = os.path.join(LOG_DIR, f"{ts}_{kind}.json")
    with open(path, "w", encoding="utf-8") as f:
        json.dump(payload, f, ensure_ascii=False, indent=2)
```

เดเดเดจเตเดฑเตเดเดณเดฟเตฝ เดฒเตเดเดฟเดเดเต เดเดจเตเดฑเดเตเดฐเตเดฑเตเดฑเต เดเตเดฏเตเดฏเตเด (เดเดเตเดเดฟเดเด):
```python
# agents/specialists.py เตฝ เดเดณเตเดณเดเดเตเดเด เดธเตเดตเตเดเดฐเดฟเดเตเดเดคเดฟเดจเต เดถเตเดทเด
from infra.obs import log_event
# ... chat(...) เตฝ เดเดณเตเดณเดฟเตฝ
resp = r.json()
log_event("chat_request", {"endpoint": f"{BASE_URL}/v1/chat/completions"})
log_event("chat_response", resp)
return resp["choices"][0]["message"]["content"]
```

เดชเดเดฟ 2) CLI เดตเดดเดฟ เดฒเดญเตเดฏเดคเดฏเตเด เดเดเดฟเดธเตเดฅเดพเดจ เดนเตเตฝเดคเตเดคเตเด เดชเดฐเดฟเดถเตเดงเดฟเดเตเดเตเด
```powershell
REM Ensure Foundry Local is running a model
foundry model list
foundry model run phi-4-mini

REM Validate the OpenAI-compatible endpoint
curl http://localhost:8000/v1/models
```

เดชเดเดฟ 3) เดฑเตเดกเดพเดเตเดทเตป, PII เดนเตเดเตเตป
- เดฎเตเดกเดฒเดฟเดฒเตเดเตเดเต เดธเดจเตเดฆเตเดถเดเตเดเตพ เดเดฏเดฏเตเดเตเดเตเดจเตเดจเดคเดฟเดจเต เดฎเตเดฎเตเดชเต เดธแแแกเดฟเดฑเตเดฑเตเดตเต เดซเตเตฝเดกเตเดเตพ (เดเดฎเตเดฏเดฟเตฝ, เดซเตเตบ เดจเดฎเตเดชเตผ, เดเดกเดฟเดเตพ) เดจเตเดเตเดเด เดเตเดฏเตเดฏเตเด เดเดฒเตเดฒเตเดเตเดเดฟเตฝ เดนเดพเดทเต เดเตเดฏเตเดฏเตเด
- เดฑเต เดธเตเดดเตโเดธเต เดกเดพเดฑเตเดฑ เดกเดฟเดตเตเดธเดฟเตฝ เดธเตเดเตเดทเดฟเดเตเดเตเด, เดเดตเดถเตเดฏเดฎเดพเดฏ เดเตเตบเดเตเดเตเดธเตเดฑเตเดฑเต เดธเตเดเตเดฐเดฟเดเดเตเดเตพ เดฎเดพเดคเตเดฐเดฎเต เดชเดพเดธเตเดธเต เดเตเดฏเตเดฏเต

เดเดฆเดพเดนเดฐเดฃ เดฑเตเดกเดพเดเตเดทเตป เดนเตเตฝเดชเตเดชเตผ:
```python
# เดเตปเดซเตเดฐ/เดฑเดฟเดกเดพเดเตเดเต.py
import re
EMAIL_RE = re.compile(r"[\w\.-]+@[\w\.-]+")
PHONE_RE = re.compile(r"\+?\d[\d\s\-]{7,}\d")

def sanitize(text: str) -> str:
    text = EMAIL_RE.sub("[REDACTED_EMAIL]", text)
    text = PHONE_RE.sub("[REDACTED_PHONE]", text)
    return text
```

เดเดเดจเตเดฑเตเดเดณเดฟเตฝ เดเดชเดฏเตเดเดฟเดเตเดเตเด:
```python
from infra.redact import sanitize
# user_goal = เดถเตเดฆเตเดงเตเดเดฐเดฟเดเตเดเตเด(user_goal)
# context = เดถเตเดฆเตเดงเตเดเดฐเดฟเดเตเดเตเด(context)
```

เดชเดเดฟ 4) เดธเตผเดเตเดฏเตเดเตเดเต เดฌเตเดฐเตเดเตเดเดฑเตเดเดณเตเด เดชเดฟเดถเดเต เดเตเดเดพเดฐเตเดฏเด เดเตเดฏเตเดฏเดฒเตเด
- เดเดฐเต เดเดเดจเตเดฑเต เดเตเตพเดเตเดเตเด try/except, เดเดเตเดธเตเดชเตเดฃเตปเดทเตเดฏเตฝ เดฌเดพเดเตเดเตเดเดซเต เดเดชเดฏเตเดเดฟเดเตเดเต เดตเตเดฐเดพเดชเตเดชเต เดเตเดฏเตเดฏเตเด
- เดเดตเตผเดคเตเดคเดฟเดเตเดเตเดจเตเดจ เดชเดฐเดพเดเดฏเดเตเดเดณเดฟเตฝ เดชเตเดชเตเดชเตโเดฒเตเตป เดทเตเตผเดเตเดเต-เดธเตผเดเตเดฏเตเดเตเดเต เดเตเดฏเตเดฏเตเด

```python
import time

def with_retry(func, retries=3, base_delay=0.5):
    for i in range(retries):
        try:
            return func()
        except Exception as e:
            if i == retries - 1:
                raise
            time.sleep(base_delay * (2 ** i))
```

เดชเดเดฟ 5) เดฒเตเดเตเดเตฝ เดเดกเดฟเดฑเตเดฑเต เดเตเดฐเตเดฏเดฟเตฝ, เดเดเตเดธเตเดชเตเตผเดเตเดเต
- JSON เดฒเตเดเตเดเตพ `./agent_logs`-เตฝ เดธเตเดเตเดทเดฟเดเตเดเตเด
- เดเดพเดฒเดเตเดฐเดฎเตเดฃ เดเดเดชเตเดฐเดธเต เดเตเดฏเตเดคเต เดฒเตเดเตเดเตพ เดฑเตเดเตเดเตเดฑเตเดฑเต เดเตเดฏเตเดฏเตเด
- เดเดตเดฒเตเดเดจเดเตเดเตพเดเตเดเต เดธเดเดเตเดฐเดนเดเตเดเตพ เดเดเตเดธเตเดชเตเตผเดเตเดเต เดเตเดฏเตเดฏเตเด (เดเดฃเตเดฃเด, เดถเดฐเดพเดถเดฐเดฟ เดฒเดพเดฑเตเดฑเตปเดธเดฟ, เดชเดฟเดถเดเต เดจเดฟเดฐเดเตเดเตเดเตพ)

เดชเดเดฟ 6) Microsoft Learn เดกเตเดเตเดธเตเดฎเดพเดฏเดฟ เดเตเดฐเตเดธเต-เดเตเดเตเดเต เดเตเดฏเตเดฏเตเด
- Foundry Local OpenAI-เดธเดฎเตผเดคเตเดฅเดฎเดพเดฏ API เดธเตเดตเดจเด เดจเตฝเดเตเดจเตเดจเต (`curl /v1/models` เดเดชเดฏเตเดเดฟเดเตเดเต เดธเดพเดงเตเดค เดชเดฐเดฟเดถเตเดงเดฟเดเตเดเต)
- เดฎเตเดกเตฝ เดฒเดญเตเดฏเดค เดธเตเดฅเดฟเดฐเตเดเดฐเดฟเดเตเดเดพเตป `foundry model run <name>` เดเดชเดฏเตเดเดฟเดเตเดเตเด
- เดเตเดฒเดฏเดจเตเดฑเต เดเดจเตเดฑเดเตเดฐเตเดทเตป, เดธเดพเดฎเตเดชเดฟเตพ เดเดชเตเดชเตเดเตพเดเตเดเดพเดฏเดฟ เดเดฆเตเดฏเตเดเดฟเด เดฎเดพเตผเดเตเดเดจเดฟเตผเดฆเตเดฆเตเดถเดเตเดเตพ เดชเดฟเดจเตเดคเตเดเดฐเตเด (Open WebUI/how-tos)

เดฑเดซเดฑเตปเดธเตเดเตพ
- **Foundry Local เดกเตเดเตเดฏเตเดฎเตเดจเตเดฑเตเดทเตป**: https://learn.microsoft.com/en-us/azure/ai-foundry/foundry-local/
- **Azure AI เดเดเดจเตเดฑเตเดเตพ**: https://learn.microsoft.com/en-us/azure/ai-services/agents/overview
- **เดฒเตเดเตเดเตฝ เดธเดพเดฎเตเดชเดฟเตพเดธเต**:
  - เดฎเตพเดเตเดเดฟ-เดเดเดจเตเดฑเต เดเตผเดเตเดเดธเตเดเตเดฐเตเดทเตป: `Module08/samples/05/multi_agent_orchestration.ipynb`
  - เดเดเดจเตเดฑเต เดจเดเดชเตเดชเดฟเดฒเดพเดเตเดเตฝ: `Module08/samples/05/agents/`
  - เดธเดพเดฎเตเดชเดฟเตพ README: `Module08/samples/05/README.md`
- **เดเดซเดฟเดทเตเดฏเตฝ Microsoft เดธเดพเดฎเตเดชเดฟเตพเดธเต**:
  - [เดซเดเดเตเดทเตป เดเตเตพ เดเตเดฏเตเดฏเตฝ](https://github.com/microsoft/Foundry-Local/tree/main/samples/python/functioncalling)
  - [เดนเตเดฒเต Foundry Local](https://github.com/microsoft/Foundry-Local/tree/main/samples/python/hello-foundry-local)
  - [Foundry Local Python SDK](https://github.com/microsoft/Foundry-Local/tree/main/sdk/python)
- **เดเดจเตเดฑเดเตเดฐเตเดทเตป เดเดฆเดพเดนเดฐเดฃเดเตเดเตพ**: https://learn.microsoft.com/en-us/azure/ai-foundry/foundry-local/how-to/how-to-chat-application-with-open-web-ui

## เดเดเตเดคเตเดค เดเดเตเดเดเตเดเตพ
- เดเตเดฒเตเดกเต-เดนเตเดธเตเดฑเตเดฑเดกเต เดเตผเดเตเดเดธเตเดเตเดฐเตเดทเดจเดพเดฏเดฟ Azure AI เดเดเดจเตเดฑเตเดเตพ เดชเดฐเดฟเดถเตเดงเดฟเดเตเดเตเด
- เดเดจเตเดฑเตผเดชเตเดฐเตเดธเต เดเดฃเดเตเดเดฑเตเดเตพ (Microsoft Graph, Search, เดกเดพเดฑเตเดฑเดพเดฌเตเดธเตเดเตพ) เดเตเตผเดเตเดเตเด

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**เดเดธเตเดฏเดพเดชเดคเตเดฐเด**:  
เด เดฐเตเด AI เดตเดฟเดตเตผเดคเตเดคเดจ เดธเตเดตเดจเด [Co-op Translator](https://github.com/Azure/co-op-translator) เดเดชเดฏเตเดเดฟเดเตเดเต เดตเดฟเดตเตผเดคเตเดคเดจเด เดเตเดฏเตเดคเดคเดพเดฃเต. เดจเดพเด เดเตเดคเตเดฏเดคเดฏเตเดเตเดเต เดถเตเดฐเดฎเดฟเดเตเดเดฟเดเตเดเตเดฃเตเดเตเดเตเดเดฟเดฒเตเด, เดธเตเดตเดฏเด เดชเตเดฐเดตเตผเดคเตเดคเดฟเดเตเดเตเดจเตเดจ เดตเดฟเดตเตผเดคเตเดคเดจเดเตเดเดณเดฟเตฝ เดชเดฟเดถเดเตเดเตพ เดเดฒเตเดฒเตเดเตเดเดฟเตฝ เดคเตเดฑเตเดฑเตเดเตพ เดเดฃเตเดเดพเดเดพเดฎเตเดจเตเดจเต เดฆเดฏเดตเดพเดฏเดฟ เดถเตเดฐเดฆเตเดงเดฟเดเตเดเตเด. เดเดคเดฟเดจเตเดฑเต เดฎเดพเดคเตเดญเดพเดทเดฏเดฟเดฒเตเดณเตเดณ เดฏเดฅเดพเตผเดคเตเดฅ เดฐเตเด เดเดงเดฟเดเดพเดฐเดชเดฐเดฎเดพเดฏ เดเดฑเดตเดฟเดเดฎเดพเดฏเดฟ เดเดฃเดเตเดเดพเดเตเดเดชเตเดชเตเดเดฃเด. เดจเดฟเตผเดฃเดพเดฏเด เดตเดฟเดตเดฐเดเตเดเตพเดเตเดเต, เดชเตเดฐเตเดซเดทเดฃเตฝ เดฎเดจเตเดทเตเดฏ เดตเดฟเดตเตผเดคเตเดคเดจเด เดถเตเดชเดพเตผเดถ เดเตเดฏเตเดฏเดชเตเดชเตเดเตเดจเตเดจเต. เด เดตเดฟเดตเตผเดคเตเดคเดจเด เดเดชเดฏเตเดเดฟเดเตเดเตเดจเตเดจเดคเดฟเตฝ เดจเดฟเดจเตเดจเตเดฃเตเดเดพเดเตเดจเตเดจ เดเดคเตเดเตเดเดฟเดฒเตเด เดคเตเดฑเตเดฑเดฟเดฆเตเดงเดพเดฐเดฃเดเตพเดเตเดเต เดตเตเดฏเดพเดเตเดฏเดพเดจเดเตเดเตเดเตเดเตพเดเตเดเต เดเดเตเดเตพ เดเดคเตเดคเดฐเดตเดพเดฆเดฟเดเดณเดฒเตเดฒ.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->